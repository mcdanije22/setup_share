{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/joshmcdaniel/Documents/work/repos/setup_share/components/CreateSetupForms/CreateSetupStepThreeForm.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from \"react\";\nimport { Button, Form, Input, Row, Col, List, Space, message, Select, Typography, Modal } from \"antd\";\nimport { ArrowRightOutlined, ArrowLeftOutlined, DeleteTwoTone } from \"@ant-design/icons\"; // @ts-ignore\n\nimport ImageMapper from \"react-image-mapper\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nconst CreateSetupStepThreeForm = ({\n  setStepThreeForm,\n  handleStepChange,\n  stepThreeForm,\n  stepTwoForm,\n  imageNumber,\n  currentStep,\n  availImagePositions,\n  removeImagePosition,\n  addImagePosition\n}) => {\n  const {\n    0: image,\n    1: setImage\n  } = useState(null);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: tempCoordList,\n    1: setTempCoordList\n  } = useState([]);\n  const {\n    0: drawingStatus,\n    1: setDrawingStatus\n  } = useState(false);\n  const {\n    0: addItemStatus,\n    1: setAddItemStatus\n  } = useState(false);\n  const {\n    0: tempAreas,\n    1: setTempAreas\n  } = useState([]);\n  const {\n    0: position,\n    1: setPosition\n  } = useState(\"\");\n  const {\n    0: modalStatus,\n    1: setModalStatus\n  } = useState(false);\n  const [form] = Form.useForm();\n  const {\n    Option\n  } = Select;\n  const {\n    Text\n  } = Typography;\n\n  const onPreview = async () => {\n    setLoading(true);\n    const src = await new Promise(resolve => {\n      const reader = new FileReader();\n      reader.readAsDataURL(stepTwoForm[imageNumber].originFileObj);\n\n      reader.onload = () => resolve(reader.result);\n    });\n    const image = new Image();\n    image.src = src;\n    setImage(src);\n    setLoading(false);\n  };\n\n  useEffect(() => {\n    onPreview();\n\n    if (imageNumber === 0 && stepThreeForm.imageOne) {\n      setTempAreas([...stepThreeForm.imageOne.areas]); //removed so that it is not double adding positions after going through and then going back.\n      //Saves image position in the image state object, just not for form\n      // setPosition(stepThreeForm.imageOne.imagePosition);\n\n      addImagePosition(stepThreeForm.imageOne.imagePosition);\n    } else if (imageNumber === 1 && stepThreeForm.imageTwo) {\n      setTempAreas([...stepThreeForm.imageTwo.areas]); // setPosition(stepThreeForm.imageTwo.imagePosition);\n\n      addImagePosition(stepThreeForm.imageTwo.imagePosition);\n    } else if (imageNumber === 2 && stepThreeForm.imageThree) {\n      setTempAreas([...stepThreeForm.imageThree.areas]); // setPosition(stepThreeForm.imageThree.imagePosition);\n\n      addImagePosition(stepThreeForm.imageThree.imagePosition);\n    }\n  }, []);\n  let MAP = {\n    name: \"image-map\",\n    imagePosition: position,\n    areas: [...tempAreas]\n  };\n\n  const startItemAdd = () => {\n    setTempAreas([{\n      id: uuidv4(),\n      name: \"\",\n      shape: \"poly\",\n      coords: [...tempCoordList],\n      preFillColor: \"green\",\n      fillColor: \"blue\",\n      url: \"\"\n    }, ...tempAreas]);\n    setAddItemStatus(true);\n  };\n\n  const cancelItemAdd = () => {\n    //not great, mutating state directly\n    tempAreas.shift();\n    MAP.areas.shift();\n    setTempCoordList([]);\n    setAddItemStatus(false);\n    setDrawingStatus(false);\n    onReset();\n  };\n\n  const startDrawing = () => {\n    setDrawingStatus(true);\n  };\n\n  const addCoordToItem = coords => {\n    setTempCoordList([...tempCoordList, ...coords]);\n  };\n\n  const undoLastCoord = () => {\n    MAP.areas[0].coords.pop();\n    MAP.areas[0].coords.pop();\n    setTempCoordList([...MAP.areas[0].coords]);\n  };\n\n  const onReset = () => {\n    form.resetFields();\n  };\n\n  const finishAddItem = values => {\n    const {\n      name,\n      url\n    } = values;\n\n    if (MAP.areas[0].coords.length === 0) {\n      message.error(\"Draw Points On Image Before Submitting\");\n    } else {\n      tempAreas[0].name = name;\n      tempAreas[0].url = url;\n      setAddItemStatus(false);\n      setDrawingStatus(false);\n      setTempCoordList([]);\n      onReset();\n    }\n  };\n\n  const removeItem = id => {\n    const currentArea = tempAreas;\n    const filteredList = currentArea.filter(item => item.id !== id);\n    setTempAreas(filteredList);\n    MAP.areas = filteredList;\n  };\n\n  const positionOnChange = values => {\n    setPosition(values);\n  };\n\n  const handleModalCancel = () => {\n    setModalStatus(false);\n  };\n\n  const addItemCheck = () => {\n    if (addItemStatus) {\n      setModalStatus(true);\n    } else {\n      submitImageData();\n    }\n  };\n\n  const submitImageData = () => {\n    if (position === \"\") {\n      message.error(\"Please Select An Image Position First\");\n    } else {\n      if (currentStep === 3) {\n        setStepThreeForm(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n          imageOne: _objectSpread({}, MAP)\n        }));\n\n        if (stepTwoForm.length > 1) {\n          handleStepChange(4);\n        } else {\n          handleStepChange(6);\n        }\n      } else if (currentStep === 4) {\n        setStepThreeForm(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n          imageTwo: _objectSpread({}, MAP)\n        }));\n\n        if (stepTwoForm.length > 2) {\n          handleStepChange(5);\n        } else {\n          handleStepChange(6);\n        }\n      } else if (currentStep === 5) {\n        setStepThreeForm(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n          imageThree: _objectSpread({}, MAP)\n        }));\n        handleStepChange(6);\n      }\n\n      removeImagePosition(MAP.imagePosition);\n    }\n  };\n\n  if (image) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"stepThreeFormContainer\",\n      children: [/*#__PURE__*/_jsxDEV(Modal, {\n        visible: modalStatus,\n        title: \"Continue?\",\n        onCancel: handleModalCancel,\n        footer: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleModalCancel,\n          className: \"buttonShadow\",\n          children: \"Go back\"\n        }, \"back\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          className: \"buttonShadow\",\n          onClick: () => {\n            setModalStatus(false);\n            cancelItemAdd();\n            submitImageData();\n          },\n          children: \"Continue\"\n        }, \"submit\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 13\n        }, this)],\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"modalContainer\",\n          style: {\n            textAlign: \"center\",\n            padding: \"1rem\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(Text, {\n            children: \"Current Item Not Submitted\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            children: \"Continue Without Adding Item?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"imgContainer\",\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          justify: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(ImageMapper, {\n              src: image,\n              map: MAP,\n              width: 500,\n              height: 350,\n              imgWidth: 1500,\n              onMouseEnter: area => {\n                alert(\"test\");\n              },\n              onImageClick: e => {\n                if (drawingStatus) {\n                  addCoordToItem([e.nativeEvent.offsetX, e.nativeEvent.offsetY]); //fixes lagging state for preview by updating local MAP object and state in same function\n\n                  MAP.areas[0].coords.push(e.nativeEvent.offsetX, e.nativeEvent.offsetY);\n                }\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          justify: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            span: 20,\n            className: \"section\",\n            children: [/*#__PURE__*/_jsxDEV(Text, {\n              children: \"Image Position\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Select, {\n              placeholder: \"Image Position\",\n              style: {\n                width: \"100%\",\n                margin: \"1rem 0\"\n              },\n              onChange: positionOnChange,\n              defaultValue: position ? position : \"\",\n              children: availImagePositions.map((item, i) => {\n                return /*#__PURE__*/_jsxDEV(Option, {\n                  value: item,\n                  children: item\n                }, i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 21\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          justify: \"center\" //need to handle height being too small and overlaping buttons\n          ,\n          style: {\n            minHeight: \"70vh\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            span: 20,\n            children: [/*#__PURE__*/_jsxDEV(Form, {\n              name: \"form\",\n              form: form,\n              labelCol: {\n                span: 24\n              },\n              wrapperCol: {\n                span: 24\n              },\n              onFinish: finishAddItem,\n              children: [addItemStatus ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n                  label: \"Item Name\",\n                  name: \"name\",\n                  rules: [{\n                    required: true,\n                    message: \"Please input a item name\"\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(Input, {\n                    placeholder: \"Playstation 5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 337,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 327,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n                  label: \"URL\",\n                  name: \"url\",\n                  rules: [{\n                    required: true,\n                    message: \"Please input a url\"\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(Input, {\n                    placeholder: \"www.amazon.com/youraffilatelink\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 346,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 339,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(Button, {\n                type: \"primary\",\n                block: true,\n                onClick: startItemAdd,\n                size: \"large\",\n                shape: \"round\",\n                className: \"buttonShadow\",\n                children: \"Add Item\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 19\n              }, this), drawingStatus ? /*#__PURE__*/_jsxDEV(Row, {\n                justify: \"space-between\",\n                children: /*#__PURE__*/_jsxDEV(Space, {\n                  direction: \"vertical\",\n                  size: 30,\n                  style: {\n                    width: \"100%\"\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(Button, {\n                    type: \"primary\",\n                    block: true,\n                    shape: \"round\",\n                    size: \"large\",\n                    htmlType: \"submit\",\n                    className: \"buttonShadow\",\n                    children: \"Submit Item\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 368,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    danger: true,\n                    block: true,\n                    shape: \"round\",\n                    size: \"large\",\n                    onClick: undoLastCoord,\n                    className: \"buttonShadow\",\n                    children: \"Undo Last point\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 378,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    danger: true,\n                    block: true,\n                    shape: \"round\",\n                    size: \"large\",\n                    onClick: cancelItemAdd,\n                    className: \"buttonShadow\",\n                    children: \"Cancel Add\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 388,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 363,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 362,\n                columnNumber: 19\n              }, this) : \"\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 15\n            }, this), addItemStatus && !drawingStatus ? /*#__PURE__*/_jsxDEV(Row, {\n              justify: \"space-between\",\n              children: /*#__PURE__*/_jsxDEV(Space, {\n                direction: \"vertical\",\n                size: 30,\n                style: {\n                  width: \"100%\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  type: \"primary\",\n                  block: true,\n                  shape: \"round\",\n                  size: \"large\",\n                  onClick: startDrawing,\n                  className: \"buttonShadow\",\n                  children: \"Draw outline\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 411,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  danger: true,\n                  block: true,\n                  size: \"large\",\n                  shape: \"round\",\n                  onClick: cancelItemAdd,\n                  className: \"buttonShadow\",\n                  children: \"Cancel Adding Item\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 421,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 406,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 405,\n              columnNumber: 17\n            }, this) : \"\", addItemStatus ? \"\" : /*#__PURE__*/_jsxDEV(List, {\n              style: {\n                marginTop: \"1rem\"\n              },\n              itemLayout: \"horizontal\",\n              children: tempAreas.map(item => {\n                return /*#__PURE__*/_jsxDEV(List.Item, {\n                  actions: [/*#__PURE__*/_jsxDEV(DeleteTwoTone, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 444,\n                    columnNumber: 35\n                  }, this)],\n                  onClick: () => {\n                    removeItem(item.id);\n                  },\n                  children: /*#__PURE__*/_jsxDEV(List.Item.Meta, {\n                    title: item.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 449,\n                    columnNumber: 25\n                  }, this)\n                }, item.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 442,\n                  columnNumber: 23\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          justify: \"space-between\",\n          style: {\n            position: \"absolute\",\n            bottom: \"0\",\n            width: \"100%\",\n            padding: \"0 1rem\",\n            height: \"64px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => {\n              handleStepChange(currentStep - 1);\n            },\n            danger: true,\n            shape: \"circle\",\n            size: \"large\",\n            icon: /*#__PURE__*/_jsxDEV(ArrowLeftOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 467,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: addItemCheck,\n            type: \"primary\",\n            htmlType: \"submit\",\n            shape: \"circle\",\n            size: \"large\",\n            icon: /*#__PURE__*/_jsxDEV(ArrowRightOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 483,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"test\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 490,\n      columnNumber: 12\n    }, this);\n  }\n};\n\nexport default CreateSetupStepThreeForm;","map":{"version":3,"sources":["/Users/joshmcdaniel/Documents/work/repos/setup_share/components/CreateSetupForms/CreateSetupStepThreeForm.tsx"],"names":["React","useEffect","useState","Button","Form","Input","Row","Col","List","Space","message","Select","Typography","Modal","ArrowRightOutlined","ArrowLeftOutlined","DeleteTwoTone","ImageMapper","v4","uuidv4","CreateSetupStepThreeForm","setStepThreeForm","handleStepChange","stepThreeForm","stepTwoForm","imageNumber","currentStep","availImagePositions","removeImagePosition","addImagePosition","image","setImage","loading","setLoading","tempCoordList","setTempCoordList","drawingStatus","setDrawingStatus","addItemStatus","setAddItemStatus","tempAreas","setTempAreas","position","setPosition","modalStatus","setModalStatus","form","useForm","Option","Text","onPreview","src","Promise","resolve","reader","FileReader","readAsDataURL","originFileObj","onload","result","Image","imageOne","areas","imagePosition","imageTwo","imageThree","MAP","name","startItemAdd","id","shape","coords","preFillColor","fillColor","url","cancelItemAdd","shift","onReset","startDrawing","addCoordToItem","undoLastCoord","pop","resetFields","finishAddItem","values","length","error","removeItem","currentArea","filteredList","filter","item","positionOnChange","handleModalCancel","addItemCheck","submitImageData","prevState","textAlign","padding","area","alert","e","nativeEvent","offsetX","offsetY","push","width","margin","map","i","minHeight","span","required","marginTop","bottom","height"],"mappings":"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","sourcesContent":["import React, { Dispatch, SetStateAction, useEffect, useState } from \"react\";\nimport {\n  Button,\n  Form,\n  Input,\n  Row,\n  Col,\n  List,\n  Space,\n  message,\n  Select,\n  Typography,\n  Modal,\n} from \"antd\";\nimport {\n  ArrowRightOutlined,\n  ArrowLeftOutlined,\n  DeleteTwoTone,\n} from \"@ant-design/icons\";\n// @ts-ignore\nimport ImageMapper from \"react-image-mapper\";\nimport { v4 as uuidv4 } from \"uuid\";\n\ninterface Props {\n  setStepThreeForm: Dispatch<SetStateAction<object>>;\n  handleStepChange(number: number): void;\n  stepThreeForm: any;\n  stepTwoForm: any;\n  imageNumber: number;\n  currentStep: number;\n  availImagePositions: Array<string>;\n  removeImagePosition(position: string): void;\n  addImagePosition(position: string): void;\n}\n\ninterface Map {\n  imagePosition: string;\n  name: string;\n  areas: Array<Area>;\n}\n\ninterface Area {\n  id: string;\n  name: string;\n  shape: string;\n  coords: Array<number>;\n  preFillColor: string;\n  fillColor: string;\n  url: string;\n}\n\ninterface FormValues {\n  name: string;\n  url: string;\n}\n\nconst CreateSetupStepThreeForm: React.FC<Props> = ({\n  setStepThreeForm,\n  handleStepChange,\n  stepThreeForm,\n  stepTwoForm,\n  imageNumber,\n  currentStep,\n  availImagePositions,\n  removeImagePosition,\n  addImagePosition,\n}) => {\n  const [image, setImage] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [tempCoordList, setTempCoordList] = useState<Array<number>>([]);\n  const [drawingStatus, setDrawingStatus] = useState(false);\n  const [addItemStatus, setAddItemStatus] = useState(false);\n  const [tempAreas, setTempAreas] = useState<Array<Area>>([]);\n  const [position, setPosition] = useState(\"\");\n  const [modalStatus, setModalStatus] = useState<boolean>(false);\n\n  const [form] = Form.useForm();\n  const { Option } = Select;\n  const { Text } = Typography;\n\n  const onPreview = async () => {\n    setLoading(true);\n    const src: any = await new Promise((resolve) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(stepTwoForm[imageNumber].originFileObj);\n      reader.onload = () => resolve(reader.result);\n    });\n\n    const image = new Image();\n    image.src = src;\n    setImage(src);\n    setLoading(false);\n  };\n  useEffect(() => {\n    onPreview();\n    if (imageNumber === 0 && stepThreeForm.imageOne) {\n      setTempAreas([...stepThreeForm.imageOne.areas]);\n      //removed so that it is not double adding positions after going through and then going back.\n      //Saves image position in the image state object, just not for form\n      // setPosition(stepThreeForm.imageOne.imagePosition);\n      addImagePosition(stepThreeForm.imageOne.imagePosition);\n    } else if (imageNumber === 1 && stepThreeForm.imageTwo) {\n      setTempAreas([...stepThreeForm.imageTwo.areas]);\n      // setPosition(stepThreeForm.imageTwo.imagePosition);\n      addImagePosition(stepThreeForm.imageTwo.imagePosition);\n    } else if (imageNumber === 2 && stepThreeForm.imageThree) {\n      setTempAreas([...stepThreeForm.imageThree.areas]);\n      // setPosition(stepThreeForm.imageThree.imagePosition);\n      addImagePosition(stepThreeForm.imageThree.imagePosition);\n    }\n  }, []);\n\n  let MAP: Map = {\n    name: \"image-map\",\n    imagePosition: position,\n    areas: [...tempAreas],\n  };\n  const startItemAdd = () => {\n    setTempAreas([\n      {\n        id: uuidv4(),\n        name: \"\",\n        shape: \"poly\",\n        coords: [...tempCoordList],\n        preFillColor: \"green\",\n        fillColor: \"blue\",\n        url: \"\",\n      },\n      ...tempAreas,\n    ]);\n    setAddItemStatus(true);\n  };\n  const cancelItemAdd = () => {\n    //not great, mutating state directly\n    tempAreas.shift();\n    MAP.areas.shift();\n    setTempCoordList([]);\n    setAddItemStatus(false);\n    setDrawingStatus(false);\n    onReset();\n  };\n  const startDrawing = () => {\n    setDrawingStatus(true);\n  };\n\n  const addCoordToItem = (coords: Array<number>) => {\n    setTempCoordList([...tempCoordList, ...coords]);\n  };\n  const undoLastCoord = () => {\n    MAP.areas[0].coords.pop();\n    MAP.areas[0].coords.pop();\n    setTempCoordList([...MAP.areas[0].coords]);\n  };\n  const onReset = () => {\n    form.resetFields();\n  };\n  const finishAddItem = (values: FormValues) => {\n    const { name, url } = values;\n    if (MAP.areas[0].coords.length === 0) {\n      message.error(\"Draw Points On Image Before Submitting\");\n    } else {\n      tempAreas[0].name = name;\n      tempAreas[0].url = url;\n      setAddItemStatus(false);\n      setDrawingStatus(false);\n      setTempCoordList([]);\n      onReset();\n    }\n  };\n  const removeItem = (id: string) => {\n    const currentArea = tempAreas;\n    const filteredList = currentArea.filter((item) => item.id !== id);\n    setTempAreas(filteredList);\n    MAP.areas = filteredList;\n  };\n  const positionOnChange = (values: string) => {\n    setPosition(values);\n  };\n  const handleModalCancel = () => {\n    setModalStatus(false);\n  };\n\n  const addItemCheck = () => {\n    if (addItemStatus) {\n      setModalStatus(true);\n    } else {\n      submitImageData();\n    }\n  };\n  const submitImageData = () => {\n    if (position === \"\") {\n      message.error(\"Please Select An Image Position First\");\n    } else {\n      if (currentStep === 3) {\n        setStepThreeForm((prevState) => ({\n          ...prevState,\n          imageOne: { ...MAP },\n        }));\n        if (stepTwoForm.length > 1) {\n          handleStepChange(4);\n        } else {\n          handleStepChange(6);\n        }\n      } else if (currentStep === 4) {\n        setStepThreeForm((prevState) => ({\n          ...prevState,\n          imageTwo: { ...MAP },\n        }));\n        if (stepTwoForm.length > 2) {\n          handleStepChange(5);\n        } else {\n          handleStepChange(6);\n        }\n      } else if (currentStep === 5) {\n        setStepThreeForm((prevState) => ({\n          ...prevState,\n          imageThree: { ...MAP },\n        }));\n        handleStepChange(6);\n      }\n      removeImagePosition(MAP.imagePosition);\n    }\n  };\n\n  if (image) {\n    return (\n      <div id=\"stepThreeFormContainer\">\n        <Modal\n          visible={modalStatus}\n          title=\"Continue?\"\n          onCancel={handleModalCancel}\n          footer={[\n            <Button\n              key=\"back\"\n              onClick={handleModalCancel}\n              className=\"buttonShadow\"\n            >\n              Go back\n            </Button>,\n            <Button\n              key=\"submit\"\n              type=\"primary\"\n              className=\"buttonShadow\"\n              onClick={() => {\n                setModalStatus(false);\n                cancelItemAdd();\n                submitImageData();\n              }}\n            >\n              Continue\n            </Button>,\n          ]}\n        >\n          <div\n            id=\"modalContainer\"\n            style={{ textAlign: \"center\", padding: \"1rem\" }}\n          >\n            <Text>Current Item Not Submitted</Text>\n            <br />\n            <Text>Continue Without Adding Item?</Text>\n          </div>\n        </Modal>\n        <div id=\"imgContainer\">\n          <Row justify=\"center\">\n            <Col>\n              <ImageMapper\n                src={image}\n                map={MAP}\n                width={500}\n                height={350}\n                imgWidth={1500}\n                onMouseEnter={(area: any) => {\n                  alert(\"test\");\n                }}\n                onImageClick={(e: any) => {\n                  if (drawingStatus) {\n                    addCoordToItem([\n                      e.nativeEvent.offsetX,\n                      e.nativeEvent.offsetY,\n                    ]);\n                    //fixes lagging state for preview by updating local MAP object and state in same function\n                    MAP.areas[0].coords.push(\n                      e.nativeEvent.offsetX,\n                      e.nativeEvent.offsetY\n                    );\n                  }\n                }}\n              />\n            </Col>\n          </Row>\n\n          <Row justify=\"center\">\n            <Col span={20} className=\"section\">\n              <Text>Image Position</Text>\n              <Select\n                placeholder=\"Image Position\"\n                style={{ width: \"100%\", margin: \"1rem 0\" }}\n                onChange={positionOnChange}\n                defaultValue={position ? position : \"\"}\n              >\n                {availImagePositions.map((item, i) => {\n                  return (\n                    <Option key={i} value={item}>\n                      {item}\n                    </Option>\n                  );\n                })}\n              </Select>\n            </Col>\n          </Row>\n\n          <Row\n            justify=\"center\"\n            //need to handle height being too small and overlaping buttons\n            style={{ minHeight: \"70vh\" }}\n          >\n            <Col span={20}>\n              <Form\n                name=\"form\"\n                form={form}\n                labelCol={{ span: 24 }}\n                wrapperCol={{ span: 24 }}\n                onFinish={finishAddItem}\n              >\n                {addItemStatus ? (\n                  <>\n                    <Form.Item\n                      label=\"Item Name\"\n                      name=\"name\"\n                      rules={[\n                        {\n                          required: true,\n                          message: \"Please input a item name\",\n                        },\n                      ]}\n                    >\n                      <Input placeholder=\"Playstation 5\" />\n                    </Form.Item>\n                    <Form.Item\n                      label=\"URL\"\n                      name=\"url\"\n                      rules={[\n                        { required: true, message: \"Please input a url\" },\n                      ]}\n                    >\n                      <Input placeholder=\"www.amazon.com/youraffilatelink\" />\n                    </Form.Item>\n                  </>\n                ) : (\n                  <Button\n                    type=\"primary\"\n                    block\n                    onClick={startItemAdd}\n                    size=\"large\"\n                    shape=\"round\"\n                    className=\"buttonShadow\"\n                  >\n                    Add Item\n                  </Button>\n                )}\n                {drawingStatus ? (\n                  <Row justify=\"space-between\">\n                    <Space\n                      direction=\"vertical\"\n                      size={30}\n                      style={{ width: \"100%\" }}\n                    >\n                      <Button\n                        type=\"primary\"\n                        block\n                        shape=\"round\"\n                        size=\"large\"\n                        htmlType=\"submit\"\n                        className=\"buttonShadow\"\n                      >\n                        Submit Item\n                      </Button>\n                      <Button\n                        danger\n                        block\n                        shape=\"round\"\n                        size=\"large\"\n                        onClick={undoLastCoord}\n                        className=\"buttonShadow\"\n                      >\n                        Undo Last point\n                      </Button>\n                      <Button\n                        danger\n                        block\n                        shape=\"round\"\n                        size=\"large\"\n                        onClick={cancelItemAdd}\n                        className=\"buttonShadow\"\n                      >\n                        Cancel Add\n                      </Button>\n                    </Space>\n                  </Row>\n                ) : (\n                  \"\"\n                )}\n              </Form>\n              {addItemStatus && !drawingStatus ? (\n                <Row justify=\"space-between\">\n                  <Space\n                    direction=\"vertical\"\n                    size={30}\n                    style={{ width: \"100%\" }}\n                  >\n                    <Button\n                      type=\"primary\"\n                      block\n                      shape=\"round\"\n                      size=\"large\"\n                      onClick={startDrawing}\n                      className=\"buttonShadow\"\n                    >\n                      Draw outline\n                    </Button>\n                    <Button\n                      danger\n                      block\n                      size=\"large\"\n                      shape=\"round\"\n                      onClick={cancelItemAdd}\n                      className=\"buttonShadow\"\n                    >\n                      Cancel Adding Item\n                    </Button>\n                  </Space>\n                </Row>\n              ) : (\n                \"\"\n              )}\n              {addItemStatus ? (\n                \"\"\n              ) : (\n                <List style={{ marginTop: \"1rem\" }} itemLayout=\"horizontal\">\n                  {tempAreas.map((item) => {\n                    return (\n                      <List.Item\n                        key={item.id}\n                        actions={[<DeleteTwoTone />]}\n                        onClick={() => {\n                          removeItem(item.id);\n                        }}\n                      >\n                        <List.Item.Meta title={item.name} />\n                      </List.Item>\n                    );\n                  })}\n                </List>\n              )}\n            </Col>\n          </Row>\n          <Row\n            justify=\"space-between\"\n            style={{\n              position: \"absolute\",\n              bottom: \"0\",\n              width: \"100%\",\n              padding: \"0 1rem\",\n              height: \"64px\",\n            }}\n          >\n            <Button\n              onClick={() => {\n                handleStepChange(currentStep - 1);\n              }}\n              danger\n              shape=\"circle\"\n              size=\"large\"\n              icon={<ArrowLeftOutlined />}\n            />\n\n            <Button\n              onClick={addItemCheck}\n              type=\"primary\"\n              htmlType=\"submit\"\n              shape=\"circle\"\n              size=\"large\"\n              icon={<ArrowRightOutlined />}\n            />\n          </Row>\n        </div>\n      </div>\n    );\n  } else {\n    return <div>test</div>;\n  }\n};\n\nexport default CreateSetupStepThreeForm;\n"]},"metadata":{},"sourceType":"module"}