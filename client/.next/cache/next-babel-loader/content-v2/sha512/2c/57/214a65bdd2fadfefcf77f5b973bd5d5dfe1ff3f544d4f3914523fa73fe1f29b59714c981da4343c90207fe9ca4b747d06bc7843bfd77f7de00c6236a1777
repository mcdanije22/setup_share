{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/joshmcdaniel/Documents/work/repos/setup_share/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/joshmcdaniel/Documents/work/repos/setup_share/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/joshmcdaniel/Documents/work/repos/setup_share/pages/analytics/[id].tsx\",\n    _s = $RefreshSig$();\n\nimport { useContext } from \"react\";\nimport styles from \"../../pageStyles/analytics.module.scss\";\nimport DashboardLayout from \"../../components/Layout/DashboardLayout\";\nimport { BaseAPI } from \"../../utils/constants/common\";\nimport axios from \"axios\";\nimport { Card, Row, Col, Modal, Button, PageHeader, Typography, Table, Space, Breadcrumb } from \"antd\";\nimport { DeleteOutlined } from \"@ant-design/icons\";\nimport Link from \"next/link\";\nimport { useEffect, useState } from \"react\";\nimport { UserContext } from \"../../utils/context/userContext\";\nvar Meta = Card.Meta;\nvar Title = Typography.Title,\n    Text = Typography.Text;\nexport var __N_SSP = true;\nexport default function AnalyticsPage(props) {\n  _s();\n\n  var _this = this;\n\n  var setUpInfo = props.setUpInfo,\n      imageItems = props.imageItems;\n\n  var _useState = useState(imageItems),\n      currentImageItems = _useState[0],\n      setCurrentImageItems = _useState[1];\n\n  var _useContext = useContext(UserContext),\n      currentUser = _useContext.currentUser,\n      setUser = _useContext.setUser;\n\n  var _useState2 = useState(),\n      selectedImageItems = _useState2[0],\n      setSelectedImageItems = _useState2[1];\n\n  var _useState3 = useState(),\n      activeSelection = _useState3[0],\n      setActiveSelection = _useState3[1];\n\n  var _useState4 = useState(false),\n      isLoading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var _useState5 = useState(false),\n      isModalOpen = _useState5[0],\n      setModalStatus = _useState5[1];\n\n  var _useState6 = useState(null),\n      selectedItem = _useState6[0],\n      setItemSelection = _useState6[1];\n\n  useEffect(function () {\n    if (!currentUser) {\n      reload();\n    }\n  }, []);\n\n  var reload = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var response, userInfo;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.get(\"\".concat(BaseAPI, \"/user/usercontext\"), {\n                withCredentials: true\n              });\n\n            case 3:\n              response = _context.sent;\n              _context.next = 6;\n              return response.data;\n\n            case 6:\n              userInfo = _context.sent;\n              setUser(userInfo);\n              _context.next = 13;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](0);\n              return _context.abrupt(\"return\", {\n                redirect: {\n                  permanent: false,\n                  destination: \"/login\"\n                }\n              });\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 10]]);\n    }));\n\n    return function reload() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (!activeSelection) {\n      setActiveSelection(setUpInfo[0].image_id);\n    }\n  }, []);\n  useEffect(function () {\n    filterActiveImageSelection();\n  }, [activeSelection]);\n\n  var filterActiveImageSelection = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var orgList, newList;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setLoading(true);\n              orgList = imageItems;\n              newList = orgList.filter(function (item) {\n                return item.image_id === activeSelection;\n              });\n              setSelectedImageItems(newList);\n              setLoading(false);\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function filterActiveImageSelection() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var tableData = selectedImageItems === null || selectedImageItems === void 0 ? void 0 : selectedImageItems.map(function (item, i) {\n    return {\n      key: item.item_id,\n      itemName: item.item_name,\n      affilateLink: item.item_url\n    };\n  });\n  var columns = [{\n    title: \"Item Name\",\n    dataIndex: \"itemName\",\n    key: \"name\"\n  }, {\n    title: \"Affilate Link\",\n    dataIndex: \"affilateLink\",\n    key: \"link\"\n  }, {\n    title: \"Clicks\",\n    dataIndex: \"age\",\n    key: \"age\"\n  }, {\n    title: \"Action\",\n    key: \"action\",\n    render: function render(text, record) {\n      return /*#__PURE__*/_jsxDEV(Space, {\n        size: \"middle\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          danger: true,\n          type: \"link\",\n          icon: /*#__PURE__*/_jsxDEV(DeleteOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 19\n          }, _this),\n          onClick: function onClick() {\n            setSelectedItem(record);\n            handleModalOpen();\n          },\n          children: \"Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, _this);\n    }\n  }];\n\n  var handleModalCancel = function handleModalCancel() {\n    setModalStatus(false);\n    setItemSelection(null);\n  };\n\n  var handleModalOpen = function handleModalOpen() {\n    setModalStatus(true);\n  };\n\n  var setSelectedItem = function setSelectedItem(item) {\n    setItemSelection(item);\n  };\n\n  var filterItemList = function filterItemList(itemId) {\n    var orgItemList = currentImageItems;\n    console.log(orgItemList);\n    orgItemList.filter(function (item) {\n      return item.item_id != itemId;\n    });\n    console.log(orgItemList);\n  };\n\n  console.log(imageItems);\n\n  var deleteItem = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              //TODO finish logic\n              // try {\n              //   const response = await axios.put(\n              //     `${BaseAPI}/setup/item/delete`,\n              //     {\n              //       itemId: selectedItem?.key,\n              //       userId: setUpInfo[0].user_id,\n              //     },\n              //     { withCredentials: true }\n              //   );\n              //   const result = await response.data;\n              //   const successMessage = await result.message;\n              //   filterItemList(selectedItem?.key);\n              //   message.success(successMessage);\n              //   handleModalCancel();\n              // } catch (error: any) {\n              //   const errorMessage = error.response.data.message;\n              //   message.error(errorMessage);\n              //   handleModalCancel();\n              // }\n              filterItemList(selectedItem === null || selectedItem === void 0 ? void 0 : selectedItem.key);\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function deleteItem() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(DashboardLayout, {\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      visible: isModalOpen,\n      title: \"Delete Item \".concat(selectedItem === null || selectedItem === void 0 ? void 0 : selectedItem.itemName, \"?\"),\n      onCancel: handleModalCancel,\n      footer: [/*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleModalCancel,\n        className: \"buttonShadow\",\n        children: \"Cancel\"\n      }, \"back\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        danger: true,\n        className: \"buttonShadow\",\n        onClick: deleteItem,\n        children: \"Delete\"\n      }, \"submit\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 11\n      }, this)],\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"modalContainer\",\n        style: {\n          textAlign: \"center\",\n          padding: \"1rem\"\n        },\n        children: /*#__PURE__*/_jsxDEV(Text, {\n          children: \"Delete Item From Setup\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: styles.analyticsContainer,\n      children: [/*#__PURE__*/_jsxDEV(Breadcrumb, {\n        children: [/*#__PURE__*/_jsxDEV(Breadcrumb.Item, {\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/dashboard\",\n            children: \"Dashboard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Breadcrumb.Item, {\n          children: [setUpInfo[0].setup_title, \" setup\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(PageHeader, {\n        style: {\n          padding: \"1rem 0\"\n        },\n        title: \"\".concat(setUpInfo[0].setup_title, \" Analytics\"),\n        subTitle: \"10 Views\",\n        extra: [/*#__PURE__*/_jsxDEV(Button, {\n          danger: true,\n          children: \"Delete\"\n        }, \"2\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 13\n        }, this)]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          gutter: [48, 28],\n          justify: \"start\",\n          children: setUpInfo.sort(function (a, b) {\n            return a.image_position_number > b.image_position_number ? 1 : -1;\n          }).map(function (setupImage, i) {\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(Col, {\n                xs: {\n                  span: 24\n                },\n                md: {\n                  span: 12\n                },\n                lg: {\n                  span: 6\n                },\n                className: styles.cardSpacer,\n                children: /*#__PURE__*/_jsxDEV(Card, {\n                  hoverable: true,\n                  cover: /*#__PURE__*/_jsxDEV(\"img\", {\n                    alt: \"setup photo\",\n                    src: setupImage.image_url\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 270,\n                    columnNumber: 27\n                  }, _this),\n                  onClick: function onClick() {\n                    console.log(setupImage.setup_id);\n                    setActiveSelection(setupImage.image_id);\n                  },\n                  children: /*#__PURE__*/_jsxDEV(Meta, {\n                    title: [/*#__PURE__*/_jsxDEV(Title, {\n                      level: 5,\n                      className: setupImage.image_id === activeSelection ? styles.active : \"\",\n                      children: [setupImage.image_position, \" Image\"]\n                    }, \"1\", true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 279,\n                      columnNumber: 29\n                    }, _this)]\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 277,\n                    columnNumber: 25\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 267,\n                  columnNumber: 23\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 21\n              }, _this)\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 19\n            }, _this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Table, {\n        style: {\n          marginTop: \"6rem\"\n        },\n        columns: columns,\n        dataSource: tableData,\n        loading: isLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 205,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AnalyticsPage, \"GlAPHOzaqgD9lS8KyT+6K0x9Qgg=\");\n\n_c = AnalyticsPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"AnalyticsPage\");","map":{"version":3,"sources":["/Users/joshmcdaniel/Documents/work/repos/setup_share/pages/analytics/[id].tsx"],"names":["useContext","styles","DashboardLayout","BaseAPI","axios","Card","Row","Col","Modal","Button","PageHeader","Typography","Table","Space","Breadcrumb","DeleteOutlined","Link","useEffect","useState","UserContext","Meta","Title","Text","AnalyticsPage","props","setUpInfo","imageItems","currentImageItems","setCurrentImageItems","currentUser","setUser","selectedImageItems","setSelectedImageItems","activeSelection","setActiveSelection","isLoading","setLoading","isModalOpen","setModalStatus","selectedItem","setItemSelection","reload","get","withCredentials","response","data","userInfo","redirect","permanent","destination","image_id","filterActiveImageSelection","orgList","newList","filter","item","tableData","map","i","key","item_id","itemName","item_name","affilateLink","item_url","columns","title","dataIndex","render","text","record","setSelectedItem","handleModalOpen","handleModalCancel","filterItemList","itemId","orgItemList","console","log","deleteItem","textAlign","padding","analyticsContainer","setup_title","sort","a","b","image_position_number","setupImage","span","cardSpacer","image_url","setup_id","active","image_position","marginTop"],"mappings":"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","sourcesContent":["import { useContext } from \"react\";\nimport styles from \"../../pageStyles/analytics.module.scss\";\nimport dashboardStyles from \"../../../components/Layout/DashboardLayout.module.scss\";\nimport DashboardLayout from \"../../components/Layout/DashboardLayout\";\nimport { GetServerSideProps } from \"next\";\nimport { pageAuthCheck } from \"../../utils/helperFunctions/pageAuthCheck\";\nimport { BaseAPI } from \"../../utils/constants/common\";\nimport axios from \"axios\";\nimport {\n  Card,\n  Row,\n  Col,\n  Modal,\n  Button,\n  PageHeader,\n  Typography,\n  Table,\n  Space,\n  Breadcrumb,\n  message,\n} from \"antd\";\nimport { DeleteOutlined } from \"@ant-design/icons\";\nimport Link from \"next/link\";\nimport { useEffect, useState } from \"react\";\nimport { UserContext } from \"../../utils/context/userContext\";\n\nconst { Meta } = Card;\nconst { Title, Text } = Typography;\n\ninterface Props {\n  setUpInfo: Array<Setup>;\n  imageItems: Array<Item>;\n}\n\ninterface Setup {\n  setup_id: string;\n  setup_title: string;\n  setup_description: string;\n  setup_type: string;\n  setup_created_date: Date;\n  created_screen_type?: any;\n  image_id: string;\n  image_url: string;\n  image_position: string;\n  image_position_number: number;\n  user_id: string;\n  username: string;\n}\n\ninterface Item {\n  item_id: string;\n  image_id: string;\n  coords_list: number[];\n  item_name: string;\n  item_url: string;\n}\n\ninterface RowItem {\n  key: string;\n  itemName: string;\n  affilateLink: string;\n}\n\nexport default function AnalyticsPage(props: Props) {\n  const { setUpInfo, imageItems } = props;\n  const [currentImageItems, setCurrentImageItems] = useState(imageItems);\n  const { currentUser, setUser } = useContext<any>(UserContext);\n  const [selectedImageItems, setSelectedImageItems] = useState<Array<Item>>();\n  const [activeSelection, setActiveSelection] = useState<string>();\n  const [isLoading, setLoading] = useState<boolean>(false);\n  const [isModalOpen, setModalStatus] = useState<boolean>(false);\n  const [selectedItem, setItemSelection] = useState<RowItem | null>(null);\n\n  useEffect(() => {\n    if (!currentUser) {\n      reload();\n    }\n  }, []);\n\n  const reload = async () => {\n    try {\n      const response = await axios.get(`${BaseAPI}/user/usercontext`, {\n        withCredentials: true,\n      });\n      const userInfo = await response.data;\n      setUser(userInfo);\n    } catch (error) {\n      return {\n        redirect: {\n          permanent: false,\n          destination: \"/login\",\n        },\n      };\n    }\n  };\n\n  useEffect(() => {\n    if (!activeSelection) {\n      setActiveSelection(setUpInfo[0].image_id);\n    }\n  }, []);\n\n  useEffect(() => {\n    filterActiveImageSelection();\n  }, [activeSelection]);\n\n  const filterActiveImageSelection = async () => {\n    setLoading(true);\n    const orgList = imageItems;\n    const newList = orgList.filter((item) => {\n      return item.image_id === activeSelection;\n    });\n    setSelectedImageItems(newList);\n    setLoading(false);\n  };\n\n  const tableData = selectedImageItems?.map((item, i) => {\n    return {\n      key: item.item_id,\n      itemName: item.item_name,\n      affilateLink: item.item_url,\n    };\n  });\n\n  const columns = [\n    {\n      title: \"Item Name\",\n      dataIndex: \"itemName\",\n      key: \"name\",\n    },\n    {\n      title: \"Affilate Link\",\n      dataIndex: \"affilateLink\",\n      key: \"link\",\n    },\n    {\n      title: \"Clicks\",\n      dataIndex: \"age\",\n      key: \"age\",\n    },\n    {\n      title: \"Action\",\n      key: \"action\",\n      render: (text: string, record: any) => (\n        <Space size=\"middle\">\n          <Button\n            danger\n            type=\"link\"\n            icon={<DeleteOutlined />}\n            onClick={() => {\n              setSelectedItem(record);\n              handleModalOpen();\n            }}\n          >\n            Delete\n          </Button>\n        </Space>\n      ),\n    },\n  ];\n  const handleModalCancel = () => {\n    setModalStatus(false);\n    setItemSelection(null);\n  };\n  const handleModalOpen = () => {\n    setModalStatus(true);\n  };\n  const setSelectedItem = (item: RowItem) => {\n    setItemSelection(item);\n  };\n  const filterItemList = (itemId: string | undefined) => {\n    const orgItemList = currentImageItems;\n    console.log(orgItemList);\n    orgItemList.filter((item) => {\n      return item.item_id != itemId;\n    });\n    console.log(orgItemList);\n  };\n  console.log(imageItems);\n  const deleteItem = async () => {\n    //TODO finish logic\n    // try {\n    //   const response = await axios.put(\n    //     `${BaseAPI}/setup/item/delete`,\n    //     {\n    //       itemId: selectedItem?.key,\n    //       userId: setUpInfo[0].user_id,\n    //     },\n    //     { withCredentials: true }\n    //   );\n    //   const result = await response.data;\n    //   const successMessage = await result.message;\n    //   filterItemList(selectedItem?.key);\n    //   message.success(successMessage);\n    //   handleModalCancel();\n    // } catch (error: any) {\n    //   const errorMessage = error.response.data.message;\n    //   message.error(errorMessage);\n    //   handleModalCancel();\n    // }\n\n    filterItemList(selectedItem?.key);\n  };\n  return (\n    <DashboardLayout>\n      <Modal\n        visible={isModalOpen}\n        title={`Delete Item ${selectedItem?.itemName}?`}\n        onCancel={handleModalCancel}\n        footer={[\n          <Button\n            key=\"back\"\n            onClick={handleModalCancel}\n            className=\"buttonShadow\"\n          >\n            Cancel\n          </Button>,\n          <Button\n            key=\"submit\"\n            danger\n            className=\"buttonShadow\"\n            onClick={deleteItem}\n          >\n            Delete\n          </Button>,\n        ]}\n      >\n        <div\n          id=\"modalContainer\"\n          style={{ textAlign: \"center\", padding: \"1rem\" }}\n        >\n          <Text>Delete Item From Setup</Text>\n        </div>\n      </Modal>\n      <div id={styles.analyticsContainer}>\n        <Breadcrumb>\n          <Breadcrumb.Item>\n            <Link href={`/dashboard`}>Dashboard</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>{setUpInfo[0].setup_title} setup</Breadcrumb.Item>\n        </Breadcrumb>\n        <PageHeader\n          style={{ padding: \"1rem 0\" }}\n          title={`${setUpInfo[0].setup_title} Analytics`}\n          subTitle=\"10 Views\"\n          extra={[\n            <Button key=\"2\" danger>\n              Delete\n            </Button>,\n          ]}\n        />\n        <div>\n          <Row gutter={[48, 28]} justify=\"start\">\n            {setUpInfo\n              .sort((a, b) =>\n                a.image_position_number > b.image_position_number ? 1 : -1\n              )\n              .map((setupImage, i) => {\n                return (\n                  <div key={i}>\n                    <Col\n                      xs={{ span: 24 }}\n                      md={{ span: 12 }}\n                      lg={{ span: 6 }}\n                      className={styles.cardSpacer}\n                    >\n                      <Card\n                        hoverable\n                        cover={\n                          <img alt=\"setup photo\" src={setupImage.image_url} />\n                        }\n                        onClick={() => {\n                          console.log(setupImage.setup_id);\n                          setActiveSelection(setupImage.image_id);\n                        }}\n                      >\n                        <Meta\n                          title={[\n                            <Title\n                              level={5}\n                              className={\n                                setupImage.image_id === activeSelection\n                                  ? styles.active\n                                  : \"\"\n                              }\n                              key=\"1\"\n                            >\n                              {setupImage.image_position} Image\n                            </Title>,\n                          ]}\n                        />\n                      </Card>\n                    </Col>\n                  </div>\n                );\n              })}\n          </Row>\n        </div>\n        <Table\n          style={{ marginTop: \"6rem\" }}\n          columns={columns}\n          dataSource={tableData}\n          loading={isLoading}\n        />\n      </div>\n    </DashboardLayout>\n  );\n}\n\nexport const getServerSideProps: GetServerSideProps = async (context) => {\n  const { id } = context.query;\n  const authCheck = await pageAuthCheck(context);\n  if (authCheck.props?.data.authd) {\n    try {\n      const response = await axios.get(`${BaseAPI}/user/analytics/${id}`);\n      const setupAnalyticsInfo = await response.data;\n      if (setupAnalyticsInfo.setUpInfo.length === 0) {\n        return {\n          redirect: {\n            permanent: false,\n            destination: \"/404\",\n          },\n        };\n      }\n      if (\n        authCheck.props.data.user !== setupAnalyticsInfo.setUpInfo[0].user_id\n      ) {\n        return {\n          redirect: {\n            permanent: false,\n            destination: \"/dashboard\",\n          },\n        };\n      } else {\n        return {\n          props: setupAnalyticsInfo,\n        };\n      }\n    } catch (e) {\n      return {\n        redirect: {\n          permanent: false,\n          destination: \"/404\",\n        },\n      };\n    }\n  } else {\n    return {\n      redirect: {\n        permanent: false,\n        destination: \"/login\",\n      },\n    };\n  }\n};\n"]},"metadata":{},"sourceType":"module"}